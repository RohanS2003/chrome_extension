(()=>{"use strict";var e={3029:(e,t,n)=>{n.r(t),n.d(t,{deleteDB:()=>p,openDB:()=>b,unwrap:()=>v,wrap:()=>h});const r=(e,t)=>t.some((t=>e instanceof t));let o,i;const a=new WeakMap,c=new WeakMap,u=new WeakMap,s=new WeakMap,l=new WeakMap;let f={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return h(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(v(this),e),h(a.get(this))}:function(...e){return h(t.apply(v(this),e))}:function(e,...n){const r=t.call(v(this),e,...n);return u.set(r,e.sort?e.sort():[e]),h(r)}:(e instanceof IDBTransaction&&function(e){if(c.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));c.set(e,t)}(e),r(e,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,f):e);var t}function h(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(h(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&a.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(s.has(e))return s.get(e);const t=d(e);return t!==e&&(s.set(e,t),l.set(t,e)),t}const v=e=>l.get(e);function b(e,t,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(e,t),c=h(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(h(a.result),e.oldVersion,e.newVersion,h(a.transaction))})),n&&a.addEventListener("blocked",(()=>n())),c.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(()=>o()))})).catch((()=>{})),c}function p(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),h(n).then((()=>{}))}const y=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],g=new Map;function m(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(g.get(t))return g.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!y.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),o&&i.done]))[0]};return g.set(t,i),i}var T;T=f,f={...T,get:(e,t,n)=>m(e,t)||T.get(e,t,n),has:(e,t)=>!!m(e,t)||T.has(e,t)}},6786:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8724),a=n(7841),c=n(5396),u=n(8599),s=n(2334),l="async-poll";chrome.alarms.create(l,{periodInMinutes:1,when:Date.now()+1e3}),chrome.alarms.onAlarm.addListener((function(e){return r(void 0,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return e.name!==l?[3,3]:((0,a.logMessage)("alarm fired"),t=Date.now(),[4,(0,s.handleAlarm)()]);case 1:return n=r.sent(),[4,(0,u.handleStateChange)(n,t)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))})),chrome.tabs.onActivated.addListener((function(e){return r(void 0,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=Date.now(),(0,a.logMessage)("tab activated: "+e.tabId),[4,(0,s.handleActiveTabStateChange)(e)];case 1:return(n=r.sent())?[4,(0,u.handleStateChange)(n,t).catch((function(e){(0,a.logMessage)("error handling tab activated: "+e)}))]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))})),chrome.tabs.onUpdated.addListener((function(e,t,n){return r(void 0,void 0,void 0,(function(){var e,t;return o(this,(function(r){switch(r.label){case 0:return e=Date.now(),(0,a.logMessage)("tab updated: "+n.id),[4,(0,s.handleTabUpdate)(n)];case 1:return(t=r.sent())?[4,(0,u.handleStateChange)(t,e).catch((function(e){(0,a.logMessage)("error handling tab activated: "+e)}))]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))})),chrome.windows.onFocusChanged.addListener((function(e){return r(void 0,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=Date.now(),(0,a.logMessage)("window focus changed: "+e),[4,(0,s.handleWindowFocusChange)(e)];case 1:return(n=r.sent())?[4,(0,u.handleStateChange)(n,t)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))})),chrome.idle.onStateChanged.addListener((function(e){return r(void 0,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return(0,a.logMessage)("idle state changed: "+e),t=Date.now(),[4,(0,s.handleIdleStateChange)(e)];case 1:return n=r.sent(),[4,(0,u.handleStateChange)(n,t)];case 2:return r.sent(),[2]}}))}))})),chrome.webNavigation.onCompleted.addListener((function(e){return r(void 0,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return(0,a.logMessage)("web navigation: "+e.tabId),t=Date.now(),[4,(0,c.getTabInfo)(e.tabId)];case 1:return(n=o.sent())?[4,(0,s.handleTabUpdate)(n)]:[2];case 2:return(r=o.sent())?[4,(0,u.handleStateChange)(r,t)]:[2];case 3:return o.sent(),[2]}}))}))})),chrome.runtime.onMessage.addListener((function(e,t,n){if(e.type===i.WAKE_UP_BACKGROUND){n({alive:!0});var r=Date.now();(0,s.handleAlarm)().then((function(e){(0,u.handleStateChange)(e,r)}))}}))},8166:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.hideBadge=t.setActionBadge=void 0;var i=n(6866),a=n(3571);function c(e,t){return new Promise((function(n){var r;return(null===(r=chrome.action)||void 0===r?void 0:r.setBadgeBackgroundColor)?chrome.action.setBadgeBackgroundColor({color:t,tabId:e},n):n()}))}function u(e,t){return new Promise((function(n){var r;return(null===(r=chrome.action)||void 0===r?void 0:r.setBadgeText)?chrome.action.setBadgeText({text:t,tabId:e},n):n()}))}t.setActionBadge=function(e){var t=e.tabId,n=e.text,s=e.color,l=void 0===s?"#4b76e3":s;return r(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,Promise.all([c(t,l),u(t,n)]).catch((0,i.ignore)(a.isTabNotExistError))];case 1:return e.sent(),[2]}}))}))},t.hideBadge=function(e){return r(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,Promise.all([u(e,"")]).catch((0,i.ignore)(a.isTabNotExistError))];case 1:return t.sent(),[2]}}))}))}},3571:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExtensionContextInvalidatedError=t.isUserDraggingWindowError=t.isCouldNotEstablishConnectionError=t.isTabNotExistError=t.throwRuntimeLastError=void 0,t.throwRuntimeLastError=function(){var e=chrome.runtime.lastError;if(null==e?void 0:e.message)throw new Error(e.message)},t.isTabNotExistError=function(e){return e instanceof Error&&e.message.toLowerCase().startsWith("no tab with id")},t.isCouldNotEstablishConnectionError=function(e){return e instanceof Error&&e.message.toLowerCase().startsWith("could not establish connection")},t.isUserDraggingWindowError=function(e){return e instanceof Error&&e.message.toLowerCase().indexOf("user may be dragging a tab")>-1},t.isExtensionContextInvalidatedError=function(e){return e instanceof Error&&e.message.toLowerCase().indexOf("extension context invalidated")>-1}},5396:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.unGreyOutTab=t.greyOutTab=t.getActiveTabFromWindowId=t.getTabFromFocusedWindow=t.getFocusedTab=t.getAllActiveTabs=t.getTabInfo=t.getActiveAudibleTab=void 0;var i=n(8724),a=n(6866),c=n(3571),u=n(6553);t.getActiveAudibleTab=function(){return chrome.tabs.query({active:!0,audible:!0})},t.getTabInfo=function(e){return r(void 0,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,chrome.tabs.get(e)];case 1:return t=r.sent(),(0,c.throwRuntimeLastError)(),[2,t];case 2:return n=r.sent(),[2,(0,a.ignore)(c.isTabNotExistError)(n)];case 3:return[2]}}))}))},t.getAllActiveTabs=function(){return chrome.tabs.query({active:!0})},t.getFocusedTab=function(){return r(void 0,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return[4,(0,u.getFocusedWindowId)()];case 1:return e=r.sent(),[4,chrome.tabs.query({windowId:e})];case 2:return t=r.sent(),(0,c.throwRuntimeLastError)(),[2,null!==(n=t.filter((function(e){return e.active}))[0])&&void 0!==n?n:t.filter((function(e){return e.highlighted}))[0]]}}))}))},t.getTabFromFocusedWindow=function(e,t){return r(void 0,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,chrome.windows.get(e)];case 1:return o.sent().focused?[4,chrome.tabs.query({windowId:e})]:[2,{}];case 2:return n=o.sent(),(0,c.throwRuntimeLastError)(),r=null!==(i=n.find((function(e){return t===e.id})))&&void 0!==i?i:null,[2,{focusedWindowId:e,focusedActiveTab:r}]}}))}))},t.getActiveTabFromWindowId=function(e){return r(void 0,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return e!==chrome.windows.WINDOW_ID_NONE?[3,2]:[4,(0,t.getActiveAudibleTab)()];case 1:return i=o.sent(),[3,4];case 2:return[4,chrome.tabs.query({windowId:e,active:!0})];case 3:i=o.sent(),o.label=4;case 4:return n=i[0],r=void 0===n?null:n,(0,c.throwRuntimeLastError)(),[2,r]}}))}))},t.greyOutTab=function(e){return r(void 0,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,chrome.tabs.sendMessage(e,{type:i.LIMIT_EXCEEDED})];case 1:return n.sent(),(0,c.throwRuntimeLastError)(),[3,3];case 2:return t=n.sent(),(0,a.ignore)(c.isTabNotExistError,c.isCouldNotEstablishConnectionError)(t),[3,3];case 3:return[2]}}))}))},t.unGreyOutTab=function(e){return r(void 0,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,chrome.tabs.sendMessage(e,{type:i.LIMIT_OK})];case 1:return n.sent(),(0,c.throwRuntimeLastError)(),[3,3];case 2:return t=n.sent(),(0,a.ignore)(c.isTabNotExistError,c.isCouldNotEstablishConnectionError)(t),[3,3];case 3:return[2]}}))}))}},6553:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFocusedWindowId=void 0,t.getFocusedWindowId=function(){return n(void 0,void 0,void 0,(function(){var e,t;return r(this,(function(n){switch(n.label){case 0:return[4,chrome.windows.getAll()];case 1:return e=n.sent(),[2,(null===(t=e.find((function(e){return e.focused})))||void 0===t?void 0:t.id)||chrome.windows.WINDOW_ID_NONE]}}))}))}},9757:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createNewActiveRecord=t.ActiveTimelineRecordDao=void 0;var i=n(7201),a=n(665),c=n(197),u=function(){function e(){this.record=null}return e.prototype.get=function(){return this.record||(this.record=(0,i.getActiveTabRecord)()),this.record},e.prototype.set=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.record=Promise.resolve(e),[4,(0,i.setActiveTabRecord)(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.isExist=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.get()];case 1:return[2,!!e.sent()]}}))}))},e}();t.ActiveTimelineRecordDao=u,t.createNewActiveRecord=function(e,t){return r(this,void 0,void 0,(function(){var n,r,u,s,l,f;return o(this,(function(o){switch(o.label){case 0:return t.id?(n=(0,a.getIsoDate)(new Date(e)),r=t.url,u=void 0===r?"":r,s=t.title,l=void 0===s?"":s,f=(0,c.getHostNameFromUrl)(u),[4,(0,i.setActiveTabRecord)({tabId:t.id,url:u,hostname:f,docTitle:l,date:n,activityPeriodStart:e,activityPeriodEnd:e})]):[2];case 1:return o.sent(),[2]}}))}))}},5608:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateTimeOnBadge=void 0;var i=n(5546),a=n(665),c=n(197),u=n(8166);t.updateTimeOnBadge=function(e,t,n){var s,l;return r(this,void 0,void 0,(function(){var r,f,d;return o(this,(function(o){switch(o.label){case 0:return(null==e?void 0:e.id)?n?[4,Promise.all([e.url?(0,i.getCurrentHostTime)((0,c.getHostNameFromUrl)(e.url)):0])]:[2,(0,u.hideBadge)(null==e?void 0:e.id)]:[2];case 1:return r=o.sent()[0],f=(null!==(s=null==t?void 0:t.activityPeriodEnd)&&void 0!==s?s:Date.now())-(null!==(l=null==t?void 0:t.activityPeriodStart)&&void 0!==l?l:Date.now()),(d=Math.floor((r+f)/1e3/60))>0?[4,(0,u.setActionBadge)({text:(0,a.presentHoursOrMinutesFromMinutes)(d),tabId:e.id,color:"#4b76e3"})]:[3,3];case 2:return o.sent(),[3,5];case 3:return[4,(0,u.hideBadge)(e.id)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}},2027:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateDomainInfo=void 0;var i=n(5286),a=n(197);t.updateDomainInfo=function(e){return r(void 0,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return(null==e?void 0:e.id)&&e.url&&"complete"===(null==e?void 0:e.status)?(t=(0,a.getHostNameFromUrl)(e.url),[4,(0,i.upsertDomainInfo)(t,{hostname:t,iconUrl:null!==(n=e.favIconUrl)&&void 0!==n?n:""})]):[2];case 1:return r.sent(),[2]}}))}))}},8599:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleStateChange=void 0;var i=n(3010),a=n(7201),c=n(665),u=n(197),s=n(9757),l=n(5608),f=n(2027),d=n(7697),h=n(5739),v=n(1623),b=(0,c.getMinutesInMs)(5);function p(e){return r(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return e?(t=(0,c.getIsoDate)(new Date),[4,(0,v.saveTimelineRecord)(e,t)]):[2];case 1:return r.sent(),n=Array.from(new Set([t,e.date])),[4,Promise.all(n.map((function(t){return(0,h.updateTotalTime)(t,e.hostname)})))];case 2:return r.sent(),[4,(0,a.setActiveTabRecord)(null)];case 3:return r.sent(),[2]}}))}))}t.handleStateChange=function(e,t){return void 0===t&&(t=Date.now()),r(void 0,void 0,void 0,(function(){var n,r,a,c,h,v,y,w,g,m,T,S,_,x,E,k,D;return o(this,(function(o){switch(o.label){case 0:return[4,(0,i.getSettings)()];case 1:return n=o.sent(),[4,(r=new s.ActiveTimelineRecordDao).get()];case 2:return a=o.sent(),c=null!==(x=e.focusedActiveTab)&&void 0!==x?x:null,h="locked"===e.idleState,v=!c,y="idle"===e.idleState&&!(null==c?void 0:c.audible),w=null!==(k=null!==(E=null==a?void 0:a.activityPeriodEnd)&&void 0!==E?E:null==a?void 0:a.activityPeriodStart)&&void 0!==k?k:t,g=t-w>b,a?(a.activityPeriodEnd=g?a.activityPeriodEnd:t,[4,r.set(a)]):[3,4];case 3:o.sent(),o.label=4;case 4:return m=n.ignoredHosts.includes(null!==(D=null==a?void 0:a.hostname)&&void 0!==D?D:""),T=function(){m||(0,d.handlePageLimitExceed)(n.limits,c,a)},Promise.all([(0,l.updateTimeOnBadge)(c,a,n.displayTimeOnBadge&&!m),(0,f.updateDomainInfo)(c),T()]),S=!(0,u.isInvalidUrl)(null==c?void 0:c.url),_=(null==a?void 0:a.url)!==(null==c?void 0:c.url),h||v||y||g||_?[4,p(a)]:[3,7];case 5:return o.sent(),c&&S&&_?[4,(0,s.createNewActiveRecord)(t,c)]:[3,7];case 6:o.sent(),o.label=7;case 7:return[2]}}))}))}},7697:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.handlePageLimitExceed=void 0;var i=n(5546),a=n(665),c=n(197),u=n(5396);t.handlePageLimitExceed=function(e,t,n){var s,l;return r(this,void 0,void 0,(function(){var r,f,d,h,v,b,p,y,w,g,m;return o(this,(function(o){switch(o.label){case 0:return(null==t?void 0:t.url)&&(null==t?void 0:t.id)&&n?(r=t.url,f=t.id,d=(0,c.getHostNameFromUrl)(r),(h=e[d])?(v=Date.now(),b=60*h*1e3,[4,(0,i.getTotalActivity)()]):[2]):[2];case 1:return p=o.sent(),y=null!==(l=null===(s=p[(0,a.getIsoDate)()])||void 0===s?void 0:s[d])&&void 0!==l?l:0,w=n.activityPeriodStart,g=void 0===w?v:w,m=n.activityPeriodEnd,y+((void 0===m?v:m)-g)>b?[4,(0,u.greyOutTab)(f)]:[3,3];case 2:return o.sent(),[3,5];case 3:return[4,(0,u.unGreyOutTab)(f)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}},5739:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateTotalTime=void 0;var i=n(5546),a=n(5269);t.updateTotalTime=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return[4,(0,a.getActivityTimeline)(e)];case 1:return n=o.sent(),r=n.filter((function(e){return e.hostname===t})).reduce((function(e,t){return e+t.activityPeriodEnd-t.activityPeriodStart}),0),[4,(0,i.setTotalDailyHostTime)({host:t,date:e,duration:r})];case 2:return o.sent(),[2]}}))}))}},1623:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveTimelineRecord=void 0;var a=n(5269);t.saveTimelineRecord=function(e,t){return o(this,void 0,void 0,(function(){var n,o,c;return i(this,(function(i){switch(i.label){case 0:return e.date!==t?[3,2]:[4,(0,a.putActivityTimelineRecord)(e)];case 1:case 4:return i.sent(),[2];case 2:return n=new Date(t).setHours(0),o=n-1,(c=r({},e)).activityPeriodEnd=o,e.activityPeriodStart=n,e.date=t,[4,(0,a.putActivityTimelineRecord)(c)];case 3:return i.sent(),[4,(0,a.putActivityTimelineRecord)(e)]}}))}))}},2334:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleAlarm=t.handleIdleStateChange=t.handleWindowFocusChange=t.handleTabUpdate=t.handleActiveTabStateChange=void 0;var a=n(7201),c=n(3571),u=n(5396),s=n(6553),l={activeTabs:[],focusedActiveTab:null,focusedWindowId:chrome.windows.WINDOW_ID_NONE,idleState:"active"};function f(){var e;return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,(0,a.getTabsState)()];case 1:return[2,null!==(e=t.sent())&&void 0!==e?e:l]}}))}))}t.handleActiveTabStateChange=function(e){return o(void 0,void 0,void 0,(function(){var n,o,s,l,d,h,v,b;return i(this,(function(i){switch(i.label){case 0:n=e.windowId,o=e.tabId,i.label=1;case 1:return i.trys.push([1,6,,7]),[4,Promise.all([(0,u.getAllActiveTabs)(),(0,u.getTabFromFocusedWindow)(n,o)])];case 2:return s=i.sent(),l=s[0],d=s[1],[4,(0,a.createTabsStateTransaction)()];case 3:return i.sent(),[4,f()];case 4:return h=i.sent(),v=r(r(r({},h),{activeTabs:l}),d),[4,(0,a.setTabsState)(v)];case 5:return i.sent(),[2,v];case 6:if(b=i.sent(),(0,c.isUserDraggingWindowError)(b))return[2,Promise.resolve((0,t.handleActiveTabStateChange)(e))];throw console.error(b),b;case 7:return[2]}}))}))},t.handleTabUpdate=function(e){return o(void 0,void 0,void 0,(function(){var t,n,o,c,s,l,d;return i(this,(function(i){switch(i.label){case 0:return e.active?[4,(0,u.getAllActiveTabs)()]:[2];case 1:return t=i.sent(),[4,(0,a.createTabsStateTransaction)()];case 2:return i.sent(),[4,f()];case 3:return n=i.sent(),o=e.audible&&n.focusedWindowId===chrome.windows.WINDOW_ID_NONE,c=(null===(d=n.focusedActiveTab)||void 0===d?void 0:d.id)===e.id&&n.focusedWindowId!==chrome.windows.WINDOW_ID_NONE,s=c||o?e:null,l=r(r({},n),{activeTabs:t,focusedActiveTab:s}),[4,(0,a.setTabsState)(l)];case 4:return i.sent(),[2,l]}}))}))},t.handleWindowFocusChange=function(e){return o(void 0,void 0,void 0,(function(){var n,o,s,l;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),[4,(0,u.getActiveTabFromWindowId)(e)];case 1:return n=i.sent(),[4,(0,a.createTabsStateTransaction)()];case 2:return i.sent(),[4,f()];case 3:return o=i.sent(),s=r(r({},o),{focusedWindowId:e,focusedActiveTab:n}),[4,(0,a.setTabsState)(s)];case 4:return i.sent(),[2,s];case 5:if(l=i.sent(),(0,c.isUserDraggingWindowError)(l))return[2,Promise.resolve((0,t.handleWindowFocusChange)(e))];throw console.error(l),l;case 6:return[2]}}))}))},t.handleIdleStateChange=function(e){return o(void 0,void 0,void 0,(function(){var t,n;return i(this,(function(o){switch(o.label){case 0:return[4,(0,a.createTabsStateTransaction)()];case 1:return o.sent(),[4,f()];case 2:return t=o.sent(),n=r(r({},t),{idleState:e}),[4,(0,a.setTabsState)(n)];case 3:return o.sent(),[2,n]}}))}))},t.handleAlarm=function(){return o(void 0,void 0,void 0,(function(){var e,n,o,c,l;return i(this,(function(i){switch(i.label){case 0:return[4,f()];case 1:return e=i.sent(),[4,(0,s.getFocusedWindowId)()];case 2:return(n=i.sent())!==e.focusedWindowId?[2,(0,t.handleWindowFocusChange)(n)]:[4,(0,u.getActiveTabFromWindowId)(n)];case 3:return(null==(o=i.sent())?void 0:o.id)===(null===(l=e.focusedActiveTab)||void 0===l?void 0:l.id)?[3,6]:[4,(0,a.createTabsStateTransaction)()];case 4:return i.sent(),c=r(r({},e),{focusedActiveTab:o}),[4,(0,a.setTabsState)(c)];case 5:return i.sent(),[2,c];case 6:return[2,e]}}))}))}},4460:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=t.DB_VERSION=t.TimeTrackerStoreStateTableKeys=t.TimeTrackerStoreTables=t.Database=void 0;var i,a,c,u=n(3029);!function(e){e.TimeTrackerStore="btt-store"}(i||(t.Database=i={})),function(e){e.Timeline="timeline",e.State="state",e.Logs="logs",e.DomainInfo="domain-info"}(a||(t.TimeTrackerStoreTables=a={})),function(e){e.ActiveTab="active-tab",e.AppState="app-state",e.OverallState="overall-state"}(c||(t.TimeTrackerStoreStateTableKeys=c={})),t.DB_VERSION=3,t.connect=function(){return(0,u.openDB)(i.TimeTrackerStore,t.DB_VERSION,{upgrade:function(e,t,n,i){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){return t<1&&((n=e.createObjectStore(a.State)).put(null,c.ActiveTab),n.put({activeTabs:[],focusedActiveTab:null,focusedWindowId:void 0,idleState:void 0},c.AppState),(r=e.createObjectStore(a.Timeline,{keyPath:"id",autoIncrement:!0})).createIndex("date","date",{unique:!1}),r.createIndex("hostname","hostname",{unique:!1}),e.createObjectStore(a.Logs,{keyPath:"id",autoIncrement:!0})),t<2&&i.objectStore(a.Timeline).createIndex("recordId","activityPeriodStart",{unique:!0}),t<3&&e.createObjectStore(a.DomainInfo,{keyPath:"hostname"}).createIndex("hostname","hostname",{unique:!0}),[2]}))}))}})}},5546:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.setTotalDailyHostTime=t.getCurrentHostTime=t.getTotalActivity=void 0;var i=n(665),a=n(9430),c=n(4460),u=function(e){return r(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,(0,c.connect)()];case 1:return t.sent().put(c.TimeTrackerStoreTables.State,e,c.TimeTrackerStoreStateTableKeys.OverallState),[2]}}))}))},s=function(e){return r(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,u(e)];case 1:return t.sent(),[4,chrome.storage.local.set({activity:e})];case 2:return t.sent(),[2]}}))}))};t.getTotalActivity=function(){return r(void 0,void 0,void 0,(function(){var e,t,n;return o(this,(function(i){switch(i.label){case 0:return[4,Promise.all([chrome.storage.local.get("activity").then((function(e){var t;return null!==(t=null==e?void 0:e.activity)&&void 0!==t?t:{}})),r(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(0,c.connect)()];case 1:return[4,e.sent().get(c.TimeTrackerStoreTables.State,c.TimeTrackerStoreStateTableKeys.OverallState)];case 2:return[2,e.sent()||{}]}}))}))])];case 1:return e=i.sent(),t=e[0],n=e[1],[2,(0,a.mergeTimeStore)(n,t)]}}))}))},t.getCurrentHostTime=function(e){return r(void 0,void 0,void 0,(function(){var n,r,a,c;return o(this,(function(o){switch(o.label){case 0:return[4,(0,t.getTotalActivity)()];case 1:return n=o.sent(),r=(0,i.getIsoDate)(new Date),[2,null!==(c=null===(a=n[r])||void 0===a?void 0:a[e])&&void 0!==c?c:0]}}))}))},t.setTotalDailyHostTime=function(e){var n=e.date,i=e.host,a=e.duration;return r(void 0,void 0,void 0,(function(){var e,r;return o(this,(function(o){switch(o.label){case 0:return[4,(0,t.getTotalActivity)()];case 1:return e=o.sent(),(null!==(r=e[n])&&void 0!==r?r:e[n]={})[i]=a,[2,s(e)]}}))}))}},8724:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LIMIT_OK=t.LIMIT_EXCEEDED=t.WAKE_UP_BACKGROUND=void 0,t.WAKE_UP_BACKGROUND="wake-up",t.LIMIT_EXCEEDED="limit-exceeded",t.LIMIT_OK="limit-ok"},3010:function(e,t){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSettings=t.setSettings=t.DEFAULT_PREFERENCES=void 0,t.DEFAULT_PREFERENCES={ignoredHosts:[],limits:{},displayTimeOnBadge:!0},t.setSettings=function(e){return r(void 0,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,(0,t.getSettings)()];case 1:return r=o.sent(),[4,chrome.storage.local.set({settings:n(n({},r),e)})];case 2:return o.sent(),[2]}}))}))},t.getSettings=function(){return r(void 0,void 0,void 0,(function(){var e,r;return o(this,(function(o){switch(o.label){case 0:return[4,chrome.storage.local.get("settings")];case 1:return e=o.sent().settings,r=void 0===e?{}:e,[2,n(n({},t.DEFAULT_PREFERENCES),r)]}}))}))}},5269:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.putActivityTimelineRecord=t.getAllActivityTimeline=t.getActivityTimeline=void 0;var i=n(4460),a=n(6866),c=n(2469);t.getActivityTimeline=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,(0,i.connect)()];case 1:return[2,t.sent().getAllFromIndex(i.TimeTrackerStoreTables.Timeline,"date",e)]}}))}))},t.getAllActivityTimeline=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(0,i.connect)()];case 1:return[2,e.sent().getAll(i.TimeTrackerStoreTables.Timeline)]}}))}))},t.putActivityTimelineRecord=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,(0,i.connect)()];case 1:return[2,t.sent().add(i.TimeTrackerStoreTables.Timeline,e).catch((0,a.ignore)(c.isKeyAlreadyExistsError,c.isUnableToAddKeyToIndexError))]}}))}))}},5286:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.selectHostnames=t.countDomains=t.getDomainInfo=t.upsertDomainInfo=void 0;var i=n(4460);t.upsertDomainInfo=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(0,i.connect)()];case 1:return[4,e.sent().put(i.TimeTrackerStoreTables.DomainInfo,t)];case 2:return e.sent(),[2]}}))}))},t.getDomainInfo=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,(0,i.connect)()];case 1:return[2,t.sent().get(i.TimeTrackerStoreTables.DomainInfo,e)]}}))}))},t.countDomains=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(0,i.connect)()];case 1:return[2,e.sent().count(i.TimeTrackerStoreTables.DomainInfo)]}}))}))},t.selectHostnames=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,(0,i.connect)()];case 1:return t=n.sent(),[2,Promise.all(e.map((function(e){return t.get(i.TimeTrackerStoreTables.DomainInfo,e)}))).then((function(e){return e.filter((function(e){return void 0!==e}))}))]}}))}))}},2469:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isUnableToAddKeyToIndexError=t.isKeyAlreadyExistsError=void 0,t.isKeyAlreadyExistsError=function(e){return e instanceof Error&&e.message.toLowerCase().indexOf("key already exists")>-1},t.isUnableToAddKeyToIndexError=function(e){return e instanceof Error&&e.message.toLowerCase().indexOf("unable to add key to index")>-1}},7841:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.logMessage=void 0;var i=n(4460);t.logMessage=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[2];case 1:return[4,t.sent().add(i.TimeTrackerStoreTables.Logs,{message:e,timestamp:Date.now()})];case 2:return t.sent(),[2]}}))}))}},7201:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createTabsStateTransaction=t.setTabsState=t.getTabsState=t.getActiveTabRecord=t.setActiveTabRecord=void 0;var i=n(4460);t.setActiveTabRecord=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,(0,i.connect)()];case 1:return[4,t.sent().put(i.TimeTrackerStoreTables.State,e,i.TimeTrackerStoreStateTableKeys.ActiveTab)];case 2:return t.sent(),[2]}}))}))},t.getActiveTabRecord=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(0,i.connect)()];case 1:return[4,e.sent().get(i.TimeTrackerStoreTables.State,i.TimeTrackerStoreStateTableKeys.ActiveTab)];case 2:return[2,e.sent()]}}))}))},t.getTabsState=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(0,i.connect)()];case 1:return[4,e.sent().get(i.TimeTrackerStoreTables.State,i.TimeTrackerStoreStateTableKeys.AppState)];case 2:return[2,e.sent()]}}))}))},t.setTabsState=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,(0,i.connect)()];case 1:return[4,t.sent().put(i.TimeTrackerStoreTables.State,e,i.TimeTrackerStoreStateTableKeys.AppState)];case 2:return t.sent(),[2]}}))}))},t.createTabsStateTransaction=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(0,i.connect)()];case 1:return[2,e.sent().transaction(i.TimeTrackerStoreTables.State,"readwrite")]}}))}))}},665:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.presentHoursOrMinutesFromMinutes=t.getDatesWeekSundayDate=t.rangeDaysAgo=t.get7DaysPriorDate=t.getTimeWithoutSeconds=t.parseTime=t.getTimeFromMs=t.getDaysInMs=t.getHoursInMs=t.getMinutesInMs=t.getIsoDate=void 0;var n=6e4,r=36e5,o=864e5;t.getIsoDate=function(e){void 0===e&&(e=new Date);var t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)},t.getMinutesInMs=function(e){return e*n},t.getHoursInMs=function(e){return e*r},t.getDaysInMs=function(e){return e*o},t.getTimeFromMs=function(e){var t=Math.floor(e/1e3%60),i=Math.floor(e/n%60),a=Math.floor(e/r%24),c=Math.floor(e/o%365);return[c>0?"".concat(c,"d"):"",a>0?"".concat(a,"h"):"",i>0?"".concat(i,"m"):"","".concat(t,"s")].filter(Boolean).join(" ")},t.parseTime=function(e){var t=Math.floor(e/1e3),i=Math.floor(e/n),a=Math.floor(e/r),c=Math.floor(e/o),u=Math.floor(e/6048e5),s=Math.floor(e/31536e6);return{days:c,hours:a,minutes:i,seconds:t,weeks:u,months:Math.floor(e/2592e6),years:s}},t.getTimeWithoutSeconds=function(e){var t=Math.floor(e/n%60),i=Math.floor(e/r%24),a=Math.floor(e/o%365);return[a>0?"".concat(a,"d"):"",i>0?"".concat(i,"h"):"",i>0&&0===t?"":"".concat(t,"m")].filter(Boolean).join(" ")};var i=function(e){return new Date(e)};t.get7DaysPriorDate=function(e,n){return(0,t.rangeDaysAgo)({from:e,days:7,map:n||i})},t.rangeDaysAgo=function(e){var t=e.from,n=e.days,r=e.map,o=new Date(t),a=r||i;return Array.from({length:n}).map((function(e,t){return o.setDate(o.getDate()-Number(t>0)),a(o)}))},t.getDatesWeekSundayDate=function(e){return void 0===e&&(e=new Date),e.setDate(e.getDate()+e.getDay()),e},t.presentHoursOrMinutesFromMinutes=function(e){if(e<60)return"".concat(e.toFixed(0),"m");var t=Math.floor(e/60),n=Math.round(e/60);return"".concat(n===t?n:n-.5,"h")}},6866:(e,t)=>{function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){if(e.some((function(e){return e(t)})))return null;throw t}}Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfNot=t.ignore=void 0,t.ignore=n,t.throwIfNot=n},9430:function(e,t){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTimeStore=void 0,t.mergeTimeStore=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var o=Object.keys(null!=e?e:{}),i=Object.keys(null!=t?t:{});return Array.from(new Set(r(r([],o,!0),i,!0))).reduce((function(r,o){var i=e[o],a=t[o];return r[o]=n(n(n({},i),a),Object.keys(n(n({},i),a)).reduce((function(e,t){var n=(null==i?void 0:i[t])||(null==a?void 0:a[t])||0,r=(null==a?void 0:a[t])||(null==i?void 0:i[t])||0;return e[t]=Math.max(n,r),e}),{})),r}),{})}},197:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isInvalidUrl=t.getHostNameFromUrl=void 0,t.getHostNameFromUrl=function(e){return new URL(e).hostname||e},t.isInvalidUrl=function(e){return!e||["chrome","about","opera","edge","coccoc","yabro"].some((function(t){return e.startsWith(t)}))}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(6786)})();